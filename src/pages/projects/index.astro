---
import { compareDesc } from "date-fns";
import { SITE_DESCRIPTION } from "@/config";
import BaseLayout from "@/layouts/BaseLayout.astro";
import type { ProjectFrontmatter } from "@/types";
import ProjectCard from "@/components/ProjectCard.astro";

const projects = (await Astro.glob<ProjectFrontmatter>("./*.mdx"))
  .filter((post) => post.frontmatter.draft !== true)
  .sort((a, b) =>
    compareDesc(
      new Date(a.frontmatter.pubDate),
      new Date(b.frontmatter.pubDate)
    )
  );
const featuredProjects = projects.filter((item) => item.frontmatter.featured);
---

<BaseLayout title="Blogs - Rohid" description={SITE_DESCRIPTION}>
  <main>
    <div class="max-w-4xl mx-auto px-6 space-y-32 my-16">
      {
        featuredProjects.length > 0 && (
          <section>
            <div class="mb-8">
              <h2 class="text-2xl font-bold">Featured Projects</h2>
            </div>
            <div class="grid md:grid-cols-2 gap-8">
              {featuredProjects.map((project) => (
                <ProjectCard url={project.url} data={project.frontmatter} />
              ))}
            </div>
          </section>
        )
      }
      <section>
        <div class="mb-8">
          <h2 class="text-2xl font-bold">All Projects</h2>
        </div>
        <div class="grid md:grid-cols-2 gap-8">
          {
            projects.map((project) => (
              <ProjectCard url={project.url} data={project.frontmatter} />
            ))
          }
        </div>
      </section>
    </div>
  </main>
</BaseLayout>
